<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <%- include('partials/head-meta') %>
    <!-- Preconnect for fonts (kept for safety if not already in head-meta) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  </head>

  <body>
    <!-- Loader (controlled by JS) -->
    <div id="loader" aria-hidden="true" class="loader-overlay" role="status" aria-label="Loading" hidden>
      <div class="mandala-spinner" aria-hidden="true"></div>
    </div>

    <!-- Skip link for keyboard users -->
    <a class="skip-link visually-hidden focusable" href="#main">Skip to main content</a>

    <!-- Header / banner -->
    <%- include('partials/header') %>

    <!-- Main content landmark -->
    <main id="main" tabindex="-1" role="main" aria-labelledby="main-heading">
      <%- body %>
    </main>

    <!-- Footer / site info -->
    <%- include('partials/footer') %>

    <!-- Dialogs and drawer (off-canvas UI) -->
    <!-- IMPORTANT: the IDs here should match what app.js expects: #cart-modal, #admin-modal, #drawer-menu, #drawer-scrim -->
    <%- include('partials/dialogs') %>
    <%- include('partials/drawer') %>

    <!-- Floating WhatsApp action (visible on small screens by CSS) -->
    <a
      class="fab-wa"
      href="https://wa.me/917990625845"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Chat with Bharadwaj Ayurveda on WhatsApp"
    >
      <!-- Inline SVG icon â€” decorative, hidden from AT -->
      <svg class="wa-ic" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path fill="currentColor" d="M20.52 3.48A11.86 11.86 0 0 0 12.02 0C5.41 0 .06 5.35.06 11.96c0 2.11.55 4.14 1.6 5.95L0 24l6.27-1.64a12 12 0 0 0 5.75 1.46h.01c6.61 0 11.96-5.35 11.96-11.96a11.86 11.86 0 0 0-3.47-8.38Z"/>
      </svg>
      <span class="visually-hidden">WhatsApp</span>
    </a>

    <!-- No-JS friendly message -->
    <noscript>
      <div class="noscript-warning" role="status" aria-live="polite">
        Please enable JavaScript to get the full experience on this site.
      </div>
    </noscript>

    <!-- Small inline helper: when a user clicks the skip link, move focus to main (keeps focus visible) -->
    <script>
      (function () {
        try {
          document.addEventListener('DOMContentLoaded', function () {
            var skip = document.querySelector('.skip-link');
            var main = document.getElementById('main');
            if (!skip || !main) return;
            skip.addEventListener('click', function (e) {
              // After navigation, give focus to main for screen readers
              setTimeout(function () {
                main.focus({ preventScroll: true });
              }, 10);
            });
          });
        } catch (e) { /* graceful fallback */ }
      }());
    </script>
  </body>
</html>
