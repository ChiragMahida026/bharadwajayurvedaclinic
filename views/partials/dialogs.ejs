<!-- dialogs.ejs (improved) -->

<!-- CART DIALOG -->
<dialog id="cart-modal" class="svc-modal" aria-labelledby="cart-title" aria-modal="true">
  <div class="modal-card" role="document">
    <header class="modal-head">
      <h3 id="cart-title">Your Cart</h3>
      <button type="button" class="icon-btn modal-close" data-dismiss="cart" aria-label="Close cart">✕</button>
    </header>

    <div id="cart-body" class="modal-body" role="region" aria-live="polite" aria-atomic="true">
      <!-- Items list (rendered by JS) -->
      <div id="cart-items" role="list" aria-label="Cart items"></div>

      <!-- Empty state -->
      <div id="cart-empty" class="small muted" hidden>No items in your cart.</div>
    </div>

    <footer class="modal-foot" aria-hidden="false">
      <div class="total" aria-live="polite">Total: ₹<span id="cart-total">0</span></div>
      <div class="modal-actions row" style="margin-top:.6rem;">
        <button type="button" class="btn" data-action="continue-shopping">Continue</button>
        <button id="checkout" type="button" class="btn btn-primary" data-action="checkout">Checkout (Razorpay UPI)</button>
      </div>
    </footer>
  </div>
</dialog>

<!-- template for cart item (use JS to clone) -->
<template id="tpl-cart-item">
  <div class="cart-item row" role="listitem">
    <img class="cart-item-img" alt="" width="64" height="64" />
    <div class="col">
      <div class="cart-item-name" data-field="name"></div>
      <div class="small muted cart-item-meta">Qty: <span data-field="qty">1</span></div>
    </div>
    <div class="cart-item-side">
      <div class="cart-item-price">₹<span data-field="price">0</span></div>
      <div class="row" style="gap:.4rem; margin-top:.4rem;">
        <button type="button" class="btn btn-ghost small" data-action="decrease" aria-label="Decrease quantity">−</button>
        <button type="button" class="btn btn-ghost small" data-action="increase" aria-label="Increase quantity">+</button>
        <button type="button" class="btn small" data-action="remove">Remove</button>
      </div>
    </div>
  </div>
</template>

<!-- ADMIN DIALOG -->
<dialog id="admin-modal" class="svc-modal" aria-labelledby="admin-title" aria-modal="true">
  <div class="modal-card" role="document">
    <header class="modal-head">
      <h3 id="admin-title">Admin Panel</h3>
      <button type="button" class="icon-btn modal-close" data-dismiss="admin" aria-label="Close admin">✕</button>
    </header>

    <!-- Login section (first view) -->
    <section id="admin-login-section" class="modal-body" aria-describedby="admin-login-help">
      <h4 class="mb-1">Login</h4>
      <p id="admin-login-help" class="small muted">
        Default: <code>admin</code> / <code>password123</code> — change in environment variables immediately.
      </p>

      <!-- NOTE: This is a stand-alone form; not nested inside another form -->
      <form id="admin-login" class="stack gap-2" novalidate>
        <label>
          Username
          <input id="admin-username" name="username" type="text" autocomplete="username" required />
        </label>

        <label>
          Password
          <input id="admin-password" name="password" type="password" autocomplete="current-password" required />
        </label>

        <div class="row" style="justify-content:flex-end;gap:.5rem">
          <button type="submit" class="btn btn-primary">Login</button>
        </div>

        <p id="admin-login-feedback" class="small muted" role="status" aria-live="polite"></p>
      </form>
    </section>

    <!-- Dashboard (hidden until logged in) -->
    <section id="admin-dashboard" class="modal-body" hidden>
      <h4 class="mb-1">Products</h4>

      <!-- Product form (stand-alone) -->
      <form id="product-form" class="grid two gap-2" novalidate>
        <input type="hidden" name="id" id="product-id" />

        <label>
          Name
          <input id="product-name" name="name" required minlength="2" />
        </label>

        <label>
          Price (₹)
          <input id="product-price" name="price" type="number" min="1" step="1" required />
        </label>

        <label class="col-span">
          Image URL
          <input id="product-imageUrl" name="imageUrl" type="url" inputmode="url" required />
        </label>

        <label class="col-span">
          Description
          <textarea id="product-description" name="description" rows="3" required></textarea>
        </label>

        <div class="col-span row" style="justify-content:flex-end;gap:.6rem">
          <button class="btn btn-primary" type="submit">Save Product</button>
          <button class="btn btn-ghost" type="reset" id="reset-product-form">Reset</button>
        </div>
      </form>

      <!-- Admin products list (rendered by JS) -->
      <div id="admin-products" class="grid three gap-2" role="list" aria-label="Products"></div>

      <!-- quick actions -->
      <div style="margin-top:1rem" class="row">
        <button type="button" id="admin-logout" class="btn">Logout</button>
        <div id="admin-feedback" class="small muted" role="status" aria-live="polite"></div>
      </div>
    </section>
  </div>
</dialog>

<!-- template for admin product card -->
<template id="tpl-admin-product">
  <article class="card admin-product" role="listitem" aria-label="Product">
    <img class="product-img" alt="" width="180" height="120" />
    <h4 class="product-name" data-field="name"></h4>
    <div class="product-price">₹<span data-field="price">0</span></div>
    <p class="small muted product-desc" data-field="description"></p>

    <div class="row" style="margin-top:.6rem;">
      <button type="button" class="btn" data-action="edit">Edit</button>
      <button type="button" class="btn btn-ghost" data-action="delete">Delete</button>
    </div>
  </article>
</template>

<!-- Non-dialog fallback (for browsers without dialog support)
     Your JS should toggle .modal-fallback[hidden] similar to dialog.showModal() -->
<div id="modal-fallback-wrapper" class="modal-fallback" hidden aria-hidden="true">
  <!-- optionally clone content here when dialog polyfill is used -->
</div>
